select
    id,
    file_id,
    substring(name, position('APGI' in name), 9) as subject_id,
    name,
    volume_id,
    volume_name,
    path,
    time_created,
    unique_hash
from data_portal.data_portal_gdsfile
where
    year(time_created) = 2023 and
    regexp_like(name, 'purple.cnv.somatic.tsv$') and
    regexp_like(path, '^((?!work).)*purple.cnv.somatic.tsv$$') and
    substring(name, position('APGI' in name), 9) in (
'APGI_1151',
'APGI_1567',
'APGI_1830',
'APGI_1839',
'APGI_1840',
'APGI_1953',
'APGI_1955',
'APGI_1959',
'APGI_1971',
'APGI_1976',
'APGI_1992',
'APGI_2040',
'APGI_2041',
'APGI_2049',
'APGI_2051',
'APGI_2052',
'APGI_2057',
'APGI_2058',
'APGI_2060',
'APGI_2106',
'APGI_2122',
'APGI_2133',
'APGI_2137',
'APGI_2146',
'APGI_2153',
'APGI_2156',
'APGI_2157',
'APGI_2185',
'APGI_2199',
'APGI_2202',
'APGI_2207',
'APGI_2210',
'APGI_2212',
'APGI_2215',
'APGI_2219',
'APGI_2221',
'APGI_2234',
'APGI_2236',
'APGI_2239',
'APGI_2259',
'APGI_2270',
'APGI_2271',
'APGI_2272',
'APGI_2278',
'APGI_2281',
'APGI_2285',
'APGI_2302',
'APGI_2303',
'APGI_2306',
'APGI_2344',
'APGI_2353',
'APGI_2523',
'APGI_2525',
'APGI_2541',
'APGI_2590',
'APGI_2591',
'APGI_2592',
'APGI_2598',
'APGI_2603',
'APGI_2622',
'APGI_2657',
'APGI_2712',
'APGI_2755',
'APGI_2781',
'APGI_2803',
'APGI_2822',
'APGI_2911',
'APGI_2920',
'APGI_2925',
'APGI_2938',
'APGI_2945',
'APGI_2946',
'APGI_2962',
'APGI_2970',
'APGI_2977',
'APGI_2992',
'APGI_2997',
'APGI_3044',
'APGI_3152',
'APGI_3198',
'APGI_3319',
'APGI_3320',
'APGI_3321',
'APGI_3322',
'APGI_3323',
'APGI_3324',
'APGI_3326',
'APGI_3327',
'APGI_3328',
'APGI_3329',
'APGI_3330',
'APGI_3331',
'APGI_3332',
'APGI_3333',
'APGI_3334',
'APGI_3335',
'APGI_3336',
'APGI_3535',
'APGI_3624',
'APGI_3796'
) 
order by subject_id desc;
